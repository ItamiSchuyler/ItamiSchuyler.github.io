<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Escritorio Itami</title>

<style>
*{box-sizing:border-box;font-family:Arial,sans-serif}
html,body{margin:0;width:100%;height:100%;overflow:hidden;background:#000}

/* Fondo */
#video-bg{
  position:fixed; inset:0;
  width:100%; height:100%;
  object-fit:cover; z-index:-1;
}

/* Escritorio */
#desktop{position:relative;width:100%;height:100%;padding:20px}
.folder{
  width:90px; color:#fff; text-align:center;
  position:absolute; cursor:grab;
}
.folder img{width:64px}

/* Ventanas */
.window{
  position:fixed; width:420px;
  background:#1b1b1b; color:#eee;
  border-radius:10px;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
  display:none;
}
.titlebar{
  background:#000; padding:8px 10px;
  display:flex; justify-content:space-between;
  cursor:move; user-select:none;
}
.controls span{margin-left:10px;cursor:pointer}
.content{padding:15px}

/* Galería */
.gallery{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.item{position:relative}
.item img,.item video{width:100%;border-radius:6px}
.overlay{
  position:absolute; inset:0;
  background:rgba(0,0,0,.75);
  display:flex; align-items:center;
  justify-content:center;
  opacity:0; transition:.3s;
}
.item:hover .overlay{opacity:1}

/* PLAYER */
#player{
  position:fixed; right:20px; bottom:70px;
  width:300px;
  background:rgba(15,15,15,.95);
  backdrop-filter:blur(10px);
  border-radius:14px;
  padding:15px; color:#fff;
  box-shadow:0 15px 40px rgba(0,0,0,.8);
  z-index:2000;
}
#player.min{height:45px;overflow:hidden}
#player h4{margin:0;font-size:14px;opacity:.8}
#song{font-size:13px;margin-top:4px;opacity:.6}
#controls{display:flex;align-items:center;gap:10px;margin-top:10px}
#play{font-size:22px;cursor:pointer}
#progress{flex:1;height:5px;background:#333;border-radius:4px;cursor:pointer}
#bar{height:100%;width:0;background:#fff;border-radius:4px}
#volume{width:60px}
#playlist{margin-top:10px;font-size:12px}
.track{padding:4px;cursor:pointer;opacity:.6}
.track.active{opacity:1}
canvas{width:100%;height:40px;margin-top:10px}
</style>
</head>

<body>

<video autoplay muted loop id="video-bg">
  <source src="fondo 1.mp4">
</video>

<div id="desktop">
  <div class="folder" data-id="itami" style="top:20px;left:20px">
    <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
    <div>itami</div>
  </div>

  <div class="folder" data-id="trabajos" style="top:120px;left:20px">
    <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
    <div>mis trabajos</div>
  </div>

  <div class="folder" data-id="codigos" style="top:220px;left:20px">
    <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
    <div>códigos</div>
  </div>
</div>

<!-- VENTANAS -->
<div class="window" id="itami">
  <div class="titlebar">Itami
    <div class="controls"><span onclick="closeWin('itami')">✕</span></div>
  </div>
  <div class="content">
    <img src="https://placekitten.com/300/200" style="width:100%;border-radius:6px">
    <p><strong>Itami</strong><br>
    Diseñador & Programador<br>
    contacto@email.com</p>
  </div>
</div>

<div class="window" id="trabajos">
  <div class="titlebar">Mis trabajos
    <div class="controls"><span onclick="closeWin('trabajos')">✕</span></div>
  </div>
  <div class="content gallery">
    <div class="item">
      <img src="https://placekitten.com/200/200">
      <div class="overlay">Proyecto 1</div>
    </div>
    <div class="item">
      <img src="https://placekitten.com/201/200">
      <div class="overlay">Proyecto 2</div>
    </div>
  </div>
</div>

<div class="window" id="codigos">
  <div class="titlebar">Códigos
    <div class="controls"><span onclick="closeWin('codigos')">✕</span></div>
  </div>
  <div class="content gallery">
    <div class="item">
      <video src="demo.mp4" muted loop></video>
      <div class="overlay">Demo web</div>
    </div>
  </div>
</div>

<!-- PLAYER -->
<div id="player">
  <h4>Music Player <span style="float:right;cursor:pointer" onclick="toggleMin()">▾</span></h4>
  <div id="song"></div>
  <canvas id="viz"></canvas>
  <div id="controls">
    <div id="play">▶</div>
    <div id="progress"><div id="bar"></div></div>
    <input id="volume" type="range" min="0" max="1" step="0.01">
  </div>
  <div id="playlist"></div>
</div>

<audio id="audio"></audio>

<script>
let z=10;
const tracks=[
 {name:'Song One',src:'song.mp3'},
 {name:'Song Two',src:'song2.mp3'}
];
let current=0;

const audio=document.getElementById('audio');
const play=document.getElementById('play');
const bar=document.getElementById('bar');
const song=document.getElementById('song');
const vol=document.getElementById('volume');
const list=document.getElementById('playlist');

tracks.forEach((t,i)=>{
 let d=document.createElement('div');
 d.className='track';
 d.textContent=t.name;
 d.onclick=()=>load(i,true);
 list.appendChild(d);
});

function load(i,auto){
 current=i;
 audio.src=tracks[i].src;
 song.textContent=tracks[i].name;
 document.querySelectorAll('.track')
   .forEach((t,j)=>t.classList.toggle('active',j===i));
 if(auto){audio.play();play.textContent='⏸'}
 save();
}

play.onclick=()=>{
 audio.paused?(audio.play(),play.textContent='⏸')
 :(audio.pause(),play.textContent='▶');
 save();
};

audio.ontimeupdate=()=>{
 bar.style.width=(audio.currentTime/audio.duration*100)+'%';
};
audio.onended=()=>load((current+1)%tracks.length,true);
vol.oninput=()=>{audio.volume=vol.value;save()};

function toggleMin(){
 document.getElementById('player').classList.toggle('min');
}

function save(){
 localStorage.setItem('player',JSON.stringify({
   current,paused:audio.paused,
   time:audio.currentTime,vol:audio.volume
 }));
}

const saved=JSON.parse(localStorage.getItem('player')||'{}');
if(saved.current!=null){
 load(saved.current,false);
 audio.currentTime=saved.time||0;
 audio.volume=saved.vol||.7;
 vol.value=audio.volume;
 if(!saved.paused){audio.play();play.textContent='⏸'}
}

/* Visualizador */
const ctx=document.getElementById('viz').getContext('2d');
const actx=new AudioContext();
const src=actx.createMediaElementSource(audio);
const analyser=actx.createAnalyser();
src.connect(analyser); analyser.connect(actx.destination);
analyser.fftSize=64;
const data=new Uint8Array(analyser.frequencyBinCount);

(function draw(){
 requestAnimationFrame(draw);
 analyser.getByteFrequencyData(data);
 ctx.clearRect(0,0,300,40);
 data.forEach((v,i)=>{
   ctx.fillStyle='#fff';
   ctx.fillRect(i*6,40-v/4,4,v/4);
 });
})();

/* Sistema */
function openWin(id){
 let w=document.getElementById(id);
 w.style.display='block';
 w.style.zIndex=++z;
}
function closeWin(id){
 document.getElementById(id).style.display='none';
}

document.querySelectorAll('.folder').forEach(f=>{
 let c=0;
 f.onclick=()=>{
   c++; setTimeout(()=>c=0,300);
   if(c===2)openWin(f.dataset.id);
 };
 f.onmousedown=e=>{
   let x=e.offsetX,y=e.offsetY;
   document.onmousemove=ev=>{
     f.style.left=(ev.pageX-x)+'px';
     f.style.top=(ev.pageY-y)+'px';
   };
   document.onmouseup=()=>document.onmousemove=null;
 };
});

document.querySelectorAll('.window').forEach(w=>{
 const bar=w.querySelector('.titlebar');
 bar.onmousedown=e=>{
   let r=w.getBoundingClientRect();
   let ox=e.clientX-r.left,oy=e.clientY-r.top;
   document.onmousemove=ev=>{
     w.style.left=(ev.clientX-ox)+'px';
     w.style.top=(ev.clientY-oy)+'px';
   };
   document.onmouseup=()=>document.onmousemove=null;
 };
});
</script>

</body>
</html>
